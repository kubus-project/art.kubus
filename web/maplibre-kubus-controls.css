/**
 * Kubus-styled MapLibre NavigationControl overrides
 * 
 * Design language: square/isometric buttons with glass morphism effect
 * matching the app's UI. Works in both dark and light modes.
 * 
 * Scoped to .maplibregl-map to avoid global style leakage.
 */

/* Control group container - square corners, subtle shadow */
.maplibregl-map .maplibregl-ctrl-group {
  border-radius: 8px !important;
  background: rgba(30, 30, 30, 0.75) !important;
  backdrop-filter: blur(10px) saturate(180%) !important;
  -webkit-backdrop-filter: blur(10px) saturate(180%) !important;
  border: 1px solid rgba(255, 255, 255, 0.1) !important;
  box-shadow: 
    0 4px 12px rgba(0, 0, 0, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.05) !important;
  overflow: hidden !important;
}

/* Light mode adaptation via media query */
@media (prefers-color-scheme: light) {
  .maplibregl-map .maplibregl-ctrl-group {
    background: rgba(255, 255, 255, 0.85) !important;
    border: 1px solid rgba(0, 0, 0, 0.1) !important;
    box-shadow: 
      0 4px 12px rgba(0, 0, 0, 0.15),
      inset 0 1px 0 rgba(255, 255, 255, 0.5) !important;
  }
}

/* Position the control with proper margins */
.maplibregl-map .maplibregl-ctrl-top-right {
  top: 80px !important; /* Below any app header/status bar */
  right: 12px !important;
}

/* Individual buttons - square, consistent sizing */
.maplibregl-map .maplibregl-ctrl-group button {
  width: 36px !important;
  height: 36px !important;
  border: none !important;
  border-radius: 0 !important;
  background-color: transparent !important;
  cursor: pointer !important;
  transition: background-color 0.15s ease, transform 0.1s ease !important;
}

.maplibregl-map .maplibregl-ctrl-group button:not(:last-child) {
  border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
}

@media (prefers-color-scheme: light) {
  .maplibregl-map .maplibregl-ctrl-group button:not(:last-child) {
    border-bottom: 1px solid rgba(0, 0, 0, 0.1) !important;
  }
}

/* Hover state */
.maplibregl-map .maplibregl-ctrl-group button:hover {
  background-color: rgba(255, 255, 255, 0.15) !important;
}

@media (prefers-color-scheme: light) {
  .maplibregl-map .maplibregl-ctrl-group button:hover {
    background-color: rgba(0, 0, 0, 0.08) !important;
  }
}

/* Active/pressed state */
.maplibregl-map .maplibregl-ctrl-group button:active {
  transform: scale(0.95) !important;
  background-color: rgba(255, 255, 255, 0.2) !important;
}

@media (prefers-color-scheme: light) {
  .maplibregl-map .maplibregl-ctrl-group button:active {
    background-color: rgba(0, 0, 0, 0.12) !important;
  }
}

/* Icons - consistent styling */
.maplibregl-map .maplibregl-ctrl-icon {
  filter: brightness(0) invert(1) !important; /* White icons for dark mode */
  opacity: 0.9 !important;
}

@media (prefers-color-scheme: light) {
  .maplibregl-map .maplibregl-ctrl-icon {
    filter: brightness(0) !important; /* Dark icons for light mode */
    opacity: 0.7 !important;
  }
}

/* Compass needle coloring */
.maplibregl-map .maplibregl-ctrl-compass {
  background-color: transparent !important;
}

.maplibregl-map .maplibregl-ctrl-compass .maplibregl-ctrl-compass-arrow {
  /* The arrow has north (red) and south (white) halves */
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Cpolygon fill='%23e74c3c' points='10,2 14,10 10,8 6,10'/%3E%3Cpolygon fill='%23ffffff' points='10,18 6,10 10,12 14,10'/%3E%3C/svg%3E") !important;
  width: 20px !important;
  height: 20px !important;
}

@media (prefers-color-scheme: light) {
  .maplibregl-map .maplibregl-ctrl-compass .maplibregl-ctrl-compass-arrow {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Cpolygon fill='%23e74c3c' points='10,2 14,10 10,8 6,10'/%3E%3Cpolygon fill='%23333333' points='10,18 6,10 10,12 14,10'/%3E%3C/svg%3E") !important;
  }
}

/* Zoom buttons icons */
.maplibregl-map .maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon,
.maplibregl-map .maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon {
  background-size: 18px 18px !important;
  background-position: center !important;
}

/* Focus state - accessibility */
.maplibregl-map .maplibregl-ctrl-group button:focus {
  outline: 2px solid rgba(100, 181, 246, 0.7) !important;
  outline-offset: -2px !important;
}

/* Hide compass when facing north (bearing is 0) - optional UX enhancement */
.maplibregl-map .maplibregl-ctrl-compass:not(.maplibregl-ctrl-compass-rotated) {
  opacity: 0.5 !important;
  transition: opacity 0.2s ease !important;
}

.maplibregl-map .maplibregl-ctrl-compass:not(.maplibregl-ctrl-compass-rotated):hover {
  opacity: 1 !important;
}

/* Ensure controls don't block pointer events outside their bounds */
.maplibregl-map .maplibregl-ctrl {
  pointer-events: auto !important;
}

.maplibregl-map .maplibregl-ctrl-top-right,
.maplibregl-map .maplibregl-ctrl-top-left,
.maplibregl-map .maplibregl-ctrl-bottom-right,
.maplibregl-map .maplibregl-ctrl-bottom-left {
  pointer-events: none !important;
}

.maplibregl-map .maplibregl-ctrl-top-right > *,
.maplibregl-map .maplibregl-ctrl-top-left > *,
.maplibregl-map .maplibregl-ctrl-bottom-right > *,
.maplibregl-map .maplibregl-ctrl-bottom-left > * {
  pointer-events: auto !important;
}

/* Pitch visualization indicator (when tilted) */
.maplibregl-map .maplibregl-ctrl-compass.maplibregl-ctrl-compass-tilted::after {
  content: '';
  position: absolute;
  bottom: 2px;
  left: 50%;
  transform: translateX(-50%);
  width: 4px;
  height: 4px;
  background: rgba(100, 181, 246, 0.8);
  border-radius: 50%;
}
